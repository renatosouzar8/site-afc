<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AFC - Site Oficial</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;900&family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --primary:#e5093a; --primary-600:#c3072f;
      --bg:#0e0f12; --surface:#15161b; --surface-2:rgba(255,255,255,.06);
      --text:#e7e7ea; --muted:#a9a9b3; --accent:#ffd66d; --info:#3b82f6;
      --border:rgba(255,255,255,.12); --glass:rgba(255,255,255,.04);
      --shadow:0 10px 30px rgba(0,0,0,.35); --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text);
      font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif;
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(229,9,58,.2), transparent 60%),
        radial-gradient(1000px 600px at 90% 10%, rgba(255,214,109,.1), transparent 60%),
        var(--bg);
      padding-top:120px;
    }

    header{
      position:fixed; inset:0 0 auto 0; z-index:1000;
      backdrop-filter:saturate(140%) blur(10px);
      background:linear-gradient(180deg, rgba(14,15,18,.8), rgba(14,15,18,.5));
      border-bottom:1px solid var(--border);
    }
    .header-inner{max-width:1100px;margin:0 auto;padding:14px 20px 6px;display:flex;flex-direction:column;align-items:center;gap:10px}
    .logo-bar{width:100%;display:flex;align-items:center;justify-content:center;gap:14px}
    .logo-bar img{height:54px;border-radius:8px;filter:drop-shadow(0 6px 12px rgba(229,9,58,.25))}
    .logo-bar h1{
      margin:0;font-family:'Outfit',sans-serif;font-weight:900;letter-spacing:.5px;font-size:2rem;
      background:linear-gradient(90deg,#fff,#ffd66d 45%,#fff 90%);-webkit-background-clip:text;background-clip:text;color:transparent;
      text-shadow:0 8px 30px rgba(255,214,109,.15);
    }

    nav{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;width:100%;padding:8px;border-top:1px solid var(--border)}
    nav .menu-item, nav .admin-btn{
      border:1px solid var(--border); background:var(--glass); color:var(--text);
      font-family:'Outfit',sans-serif;font-weight:700;letter-spacing:.4px;text-transform:uppercase;
      font-size:.85rem;padding:10px 16px;border-radius:999px;cursor:pointer;
      transition:transform .15s, background .2s, border-color .2s;
    }
    nav .menu-item:hover{background:rgba(255,255,255,.08);transform:translateY(-1px)}
    nav .menu-item.active{background:linear-gradient(180deg,var(--primary),var(--primary-600));border-color:transparent;box-shadow:0 8px 20px rgba(229,9,58,.35);color:#fff}
    nav .admin-btn{background:linear-gradient(180deg,#6e5d12,#5b4c0e);border-color:rgba(255,214,109,.2);color:#fff}

    main{max-width:1100px;margin:20px auto;padding:0 20px 60px}
    section{display:none}
    section.active{display:block;animation:fadeIn .45s ease}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

    h2{
      font-family:'Outfit',sans-serif;font-weight:900;letter-spacing:.2px;font-size:2rem;text-align:center;margin:0 0 22px;
      background:linear-gradient(90deg,#fff,#ffd66d 60%,#fff);-webkit-background-clip:text;background-clip:text;color:transparent;
    }
    h3{font-family:'Outfit',sans-serif;font-weight:700;font-size:1.2rem;margin:0 0 16px;color:#fff;display:flex;align-items:center;gap:10px}

    .card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid var(--border);border-radius:var(--radius);padding:22px;box-shadow:var(--shadow)}

    /* Home hero */
    #home-card{
      position:relative;text-align:center;padding:36px 22px;overflow:hidden;
      background:linear-gradient(rgba(12,12,16,.75),rgba(12,12,16,.85)), url('https://renatosouzar8.github.io/site-afc/galeria/escudo-afc.png') center/220px no-repeat;
    }
    #home-card .welcome-title{font-family:'Outfit',sans-serif;font-size:2rem;font-weight:900;margin-bottom:10px}
    #home-card .welcome-text{color:var(--muted);font-size:1.05rem;max-width:640px;margin:0 auto 22px}

    /* Pr√≥ximo jogo */
    #home-next-game{margin:0 auto;max-width:560px;background:rgba(229,9,58,.08);border:1px solid rgba(229,9,58,.35);border-radius:14px;padding:16px}
    #home-next-game h4{margin:0 0 6px;color:var(--accent);font-family:'Outfit',sans-serif;letter-spacing:.5px;text-transform:uppercase;font-size:.95rem}
    #home-next-game .match{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .match .teams{font-weight:800;font-size:1.15rem}
    .match .date-badge{display:inline-flex;align-items:center;gap:8px;background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:999px;padding:8px 12px;color:#fff;font-weight:600}
    .match .countdown{font-size:.9rem;color:var(--muted)}

    /* Tabelas */
    table{width:100%;border-collapse:collapse;margin-top:12px;overflow:clip;border-radius:10px}
    thead th{
      position:sticky;top:0;background:linear-gradient(180deg,var(--primary),var(--primary-600));
      color:#fff;font-family:'Outfit',sans-serif;font-weight:800;text-transform:uppercase;font-size:.85rem;letter-spacing:.4px;padding:14px;text-align:center;
    }
    tbody td{padding:14px;text-align:center;background:rgba(255,255,255,.03);border-bottom:1px solid var(--border)}
    tbody tr:nth-child(even) td{background:rgba(255,255,255,.045)}
    tbody tr:hover td{background:rgba(229,9,58,.12)}

    .card-list{display:grid;gap:12px}
    .item-card{display:grid;gap:8px;background:var(--surface-2);border:1px solid var(--border);border-radius:12px;padding:14px;transition:transform .15s, background .2s, border-color .2s}
    .item-card:hover{transform:translateY(-2px);background:rgba(255,255,255,.07);border-color:rgba(229,9,58,.35)}
    .item-title{font-weight:800}
    .item-sub{color:var(--muted);font-size:.95rem}

    .stats-row{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));margin-bottom:6px}
    .stat-box{background:var(--surface-2);border:1px solid var(--border);border-radius:12px;padding:18px;text-align:center;transition:transform .15s, background .2s, border-color .2s}
    .stat-box:hover{transform:translateY(-2px);background:rgba(255,255,255,.07);border-color:rgba(229,9,58,.35)}
    .stat-number{font-family:'Outfit',sans-serif;font-size:2rem;font-weight:900;color:var(--accent)}
    .stat-label{font-size:.85rem;text-transform:uppercase;color:var(--muted)}

    .bar-chart{margin-top:16px;background:var(--surface-2);border:1px solid var(--border);border-radius:12px;padding:16px}
    .bar-chart h4{margin:0 0 10px;font-family:'Outfit',sans-serif}
    .bar{display:grid;grid-template-columns:140px 1fr;gap:12px;align-items:center;padding:6px 0}
    .bar .label{font-weight:700;color:#fff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .bar .track{position:relative;height:14px;background:rgba(255,255,255,.08);border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .bar .fill-goals{position:absolute;inset:0 auto 0 0;width:0;background:linear-gradient(90deg,var(--primary),var(--primary-600));transition:width .6s}
    .bar .fill-assists{position:absolute;inset:0 auto 0 0;width:0;background:linear-gradient(90deg,var(--info),#2563eb);opacity:.75;transition:width .6s .05s}

    .gallery-card{margin-top:16px}
    .gallery-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .gallery-item{position:relative;overflow:hidden;border-radius:12px;border:1px solid var(--border);background:var(--surface-2);cursor:zoom-in}
    .gallery-item img{width:100%;height:180px;object-fit:cover;display:block;transition:transform .3s, filter .3s}
    .gallery-item:hover img{transform:scale(1.04);filter:brightness(1.05)}

    .lightbox{display:none;position:fixed;inset:0;z-index:3000;background:rgba(0,0,0,.75);backdrop-filter:blur(4px);align-items:center;justify-content:center;padding:20px}
    .lightbox.open{display:flex}
    .lightbox img{max-width:95vw;max-height:85vh;border-radius:12px;border:1px solid var(--border);box-shadow:var(--shadow)}
    .lightbox .close{position:absolute;top:14px;right:14px;background:var(--glass);color:#fff;border:1px solid var(--border);border-radius:999px;padding:8px 12px;cursor:pointer}
    .lightbox .close:hover{background:rgba(255,255,255,.08)}

    #admin-login{display:none;position:fixed;inset:0;z-index:2000;background:rgba(0,0,0,.55);backdrop-filter:blur(6px);align-items:center;justify-content:center}
    #admin-login .modal{background:var(--surface);border:1px solid var(--border);color:var(--text);padding:24px;border-radius:14px;width:92%;max-width:360px;box-shadow:var(--shadow)}
    #admin-login input{width:100%;padding:12px;margin:10px 0 6px;background:rgba(255,255,255,.06);border:1px solid var(--border);color:#fff;border-radius:10px}
    #admin-login button{padding:10px 16px;margin:10px 6px 0 0;border:1px solid var(--border);background:var(--glass);color:#fff;border-radius:10px;cursor:pointer}

    .admin-card{background:var(--surface-2);border:1px solid var(--border);border-radius:12px;padding:20px;margin-top:18px}
    .admin-form-table{width:100%}
    .admin-form-table td,.admin-form-table th{padding:6px;text-align:left}
    .admin-form-table input,#admin-panel textarea{width:100%;padding:10px;background:rgba(255,255,255,.06);border:1px solid var(--border);color:#fff;border-radius:10px}
    #admin-panel button{background:linear-gradient(180deg,var(--primary),var(--primary-600));color:#fff;border:none;padding:12px 18px;border-radius:10px;font-size:1rem;cursor:pointer;margin-top:10px;font-weight:700;box-shadow:0 8px 18px rgba(229,9,58,.3)}
    .action-button{background:linear-gradient(180deg,#16a34a,#0f8a3c)!important;box-shadow:0 8px 18px rgba(16,185,129,.25)!important}
    .admin-thumb{width:80px;height:56px;object-fit:cover;border-radius:8px;border:1px solid var(--border);background:rgba(255,255,255,.05)}
    .admin-remove{background:#b91c1c;color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}

    @media (max-width:768px){
      table{display:none}
      .table-as-cards{display:grid;gap:12px}
      .bar{grid-template-columns:1fr}
      #home-card{background-size:160px}
      .match{gap:8px}
      .match .teams{font-size:1rem}
    }
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="logo-bar">
        <img src="https://renatosouzar8.github.io/site-afc/galeria/escudo-afc.png" alt="AFC Escudo">
        <h1>AFC</h1>
      </div>
      <nav>
        <button class="menu-item active" data-tab="home">In√≠cio</button>
        <button class="menu-item" data-tab="jogadores">Jogadores</button>
        <button class="menu-item" data-tab="calendario">Calend√°rio</button>
        <button class="menu-item" data-tab="historico">Hist√≥rico</button>
        <button class="menu-item" data-tab="estatisticas">Estat√≠sticas</button>
        <button class="admin-btn" id="admin-btn">‚öôÔ∏è Admin</button>
      </nav>
    </div>
  </header>

  <main>
    <section id="home" class="active">
      <div id="home-card" class="card">
        <div class="welcome-title">‚öΩ Bem-vindos ao AFC</div>
        <div class="welcome-text">O AFC √© mais que um clube, √© uma fam√≠lia unida pela paix√£o do futebol.</div>
        <div id="home-next-game"></div>
      </div>

      <div class="card gallery-card">
        <h3>Fotos do Grupo</h3>
        <div class="gallery-grid" id="gallery-grid"></div>
      </div>
    </section>

    <section id="jogadores">
      <h2>Elenco</h2>
      <div class="card">
        <div id="jogadores-cards" class="card-list"></div>
        <table id="jogadores-table">
          <thead><tr><th>Jogador</th><th>Posi√ß√£o</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="calendario">
      <h2>Calend√°rio de Jogos</h2>
      <div class="card">
        <div id="calendario-cards" class="card-list"></div>
        <table id="calendario-table">
          <thead><tr><th>Pr√≥ximos confrontos</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="historico">
      <h2>Hist√≥rico de Confrontos</h2>
      <div class="card" id="historico-filtro">
        <h3>Retrospecto por Advers√°rio</h3>
        <label for="adversario-select">Selecione o Advers√°rio:</label>
        <select id="adversario-select"></select>
        <div id="historico-resumo"></div>
      </div>
      <div class="card">
        <h3>Jogos Realizados</h3>
        <div id="historico-passados-cards" class="card-list table-as-cards"></div>
        <table id="historico-jogos-passados-table">
          <thead><tr><th>Data</th><th>Advers√°rio</th><th>Resultado</th><th>Detalhes</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="estatisticas">
      <h2>Estat√≠sticas</h2>
      <div class="card">
        <h3>Desempenho Geral do Time</h3>
        <div class="stats-row" id="estatisticas-gerais"></div>
      </div>
      <div class="card">
        <h3>Artilharia e Assist√™ncias</h3>
        <table id="estatisticas-jogadores-table">
          <thead><tr><th>Jogador</th><th>Posi√ß√£o</th><th>Gols</th><th>Assist√™ncias</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="bar-chart" id="grafico-barras">
          <h4>Gols e Assist√™ncias por Jogador</h4>
          <div id="bars-container"></div>
        </div>
      </div>
    </section>

    <section id="admin-panel">
      <h2>Painel de Administra√ß√£o</h2>

      <div class="admin-card">
        <h3>Editar Calend√°rio e Resultados</h3>
        <table class="admin-form-table">
          <thead><tr><th>Data</th><th>Advers√°rio</th><th>Resultado</th><th>Detalhes</th></tr></thead>
          <tbody id="admin-calendario-tbody"></tbody>
        </table>
      </div>

      <div class="admin-card">
        <h3>Editar Estat√≠sticas dos Jogadores</h3>
        <table class="admin-form-table">
          <thead><tr><th>Jogador</th><th>Gols</th><th>Assist√™ncias</th></tr></thead>
          <tbody id="admin-jogadores-tbody"></tbody>
        </table>
      </div>

      <div class="admin-card">
        <h3>Gerenciar Galeria</h3>
        <p>Voc√™ pode usar links absolutos (GitHub Pages) ou caminhos relativos do projeto.</p>
        <table class="admin-form-table">
          <thead><tr><th>Pr√©-visualiza√ß√£o</th><th>Caminho (src)</th><th>Descri√ß√£o (alt)</th><th>A√ß√µes</th></tr></thead>
          <tbody id="admin-galeria-tbody"></tbody>
        </table>
        <button id="btn-add-galeria-item" class="action-button">Adicionar Foto</button>
        <button id="btn-refresh-galeria" style="margin-left:8px;">Recarregar Galeria no Site</button>
      </div>

      <div class="admin-card">
        <h3>Exportar/Importar Dados</h3>
        <button id="btn-generate-from-forms" class="action-button">Gerar JSON a partir dos Formul√°rios</button>
        <textarea id="json-output-area" placeholder="O JSON gerado aparecer√° aqui..."></textarea>
        <button id="btn-download-generated" style="display:none;">Baixar JSON Gerado</button>
        <p id="admin-msg-generate" style="margin-top:10px;"></p>

        <button id="btn-clear-storage" style="margin-top:8px;background:#374151;border:none;color:#fff;padding:10px 14px;border-radius:8px;cursor:pointer;">
          Limpar dados salvos no navegador
        </button>
        <p id="admin-msg-clear" style="margin-top:8px;color:#a9a9b3;"></p>

        <textarea id="json-input-area" placeholder="Cole aqui o conte√∫do do arquivo dados_afc.json..."></textarea>
        <button id="btn-carregar-json">Carregar Novos Dados</button>
        <p id="admin-msg-load" style="margin-top:10px;"></p>
      </div>
    </section>
  </main>

  <div class="lightbox" id="lightbox">
    <button class="close" id="lightbox-close">Fechar ‚úï</button>
    <img id="lightbox-img" src="" alt="Foto ampliada" />
  </div>

  <div id="admin-login">
    <div class="modal">
      <h3>√Årea Administrativa</h3>
      <input type="password" id="admin-pass" placeholder="Senha" />
      <div>
        <button onclick="checkPassword()">Entrar</button>
        <button onclick="closeAdmin()">Cancelar</button>
      </div>
      <p id="admin-msg-login" style="color:#ff6b6b;"></p>
    </div>
  </div>

  <script>
    const STORAGE_KEY = 'afc_site_data_v1';

    const initialData = {
      jogadores: [
        {"nome":"Maur√≠lio","posicao":"Goleiro","gols":0,"assistencias":0},
        {"nome":"Diego","posicao":"Zagueiro","gols":0,"assistencias":0},
        {"nome":"Dit√£o","posicao":"Zagueiro","gols":0,"assistencias":0},
        {"nome":"Wando","posicao":"Zagueiro","gols":0,"assistencias":0},
        {"nome":"Rafael Moura","posicao":"Zagueiro","gols":0,"assistencias":0},
        {"nome":"Cl√©ber","posicao":"Lateral","gols":0,"assistencias":0},
        {"nome":"Rique","posicao":"Lateral","gols":0,"assistencias":0},
        {"nome":"Tael","posicao":"Lateral","gols":0,"assistencias":0},
        {"nome":"Felipe Fran√ßa","posicao":"Volante","gols":0,"assistencias":0},
        {"nome":"Felipe Costa","posicao":"Volante","gols":0,"assistencias":0},
        {"nome":"Edgar","posicao":"Volante","gols":0,"assistencias":0},
        {"nome":"Renato","posicao":"Meia","gols":4,"assistencias":2},
        {"nome":"Neto","posicao":"Meia","gols":6,"assistencias":5},
        {"nome":"Renan","posicao":"Meia","gols":0,"assistencias":0},
        {"nome":"Higor","posicao":"Meia","gols":0,"assistencias":0},
        {"nome":"William","posicao":"Meia","gols":0,"assistencias":0},
        {"nome":"Rafael","posicao":"Atacante","gols":0,"assistencias":0},
        {"nome":"Kelvin","posicao":"Atacante","gols":0,"assistencias":0},
        {"nome":"Amaral","posicao":"Atacante","gols":0,"assistencias":0},
        {"nome":"Edinho","posicao":"Atacante","gols":0,"assistencias":0},
        {"nome":"Ricardinho","posicao":"Atacante","gols":0,"assistencias":0}
      ],
      calendario: [
        {"data":"2025-07-27","adversario":"Base 6","resultado":"3x2","detalhes":"Gols: Neto, Jefferson (2)"},
        {"data":"2025-08-03","adversario":"EC Sem Nome","resultado":null,"detalhes":""},
        {"data":"2025-08-10","adversario":"Bandeirantes","resultado":null,"detalhes":""}
      ],
      galeria: [
        { src:"https://renatosouzar8.github.io/site-afc/galeria/foto_afc_campo.jpeg", alt:"Time AFC em campo" },
        { src:"https://renatosouzar8.github.io/site-afc/galeria/escudo-afc.png", alt:"Escudo do AFC" }
      ]
    };

    function saveToStorage(data){try{localStorage.setItem(STORAGE_KEY,JSON.stringify(data))}catch(e){}}
    function loadFromStorage(){try{const s=localStorage.getItem(STORAGE_KEY);return s?JSON.parse(s):null}catch(e){return null}}
    function normalizeData(d){return{jogadores:Array.isArray(d?.jogadores)?d.jogadores:[],calendario:Array.isArray(d?.calendario)?d.calendario:[],galeria:Array.isArray(d?.galeria)?d.galeria:[]}}

    let siteData = normalizeData(loadFromStorage() || initialData);
    if(!loadFromStorage()) saveToStorage(siteData);

    let generatedJsonString = '';
    const DESKTOP_CARDS_JOGADORES = true;
    const DESKTOP_CARDS_CALENDARIO = true;

    function renderHome(){
      const nextGameContainer=document.getElementById('home-next-game');
      const proximosJogos=siteData.calendario.filter(j=>!j.resultado).sort((a,b)=>new Date(a.data)-new Date(b.data));
      if(proximosJogos.length>0){
        const proximoJogo=proximosJogos[0];
        const dateObj=new Date(proximoJogo.data+'T00:00:00');
        const dataFormatada=dateObj.toLocaleDateString('pt-BR',{weekday:'long',day:'2-digit',month:'long'});
        nextGameContainer.innerHTML=`
          <h4>Pr√≥ximo Confronto</h4>
          <div class="match">
            <div class="teams">AFC x ${proximoJogo.adversario}</div>
            <div class="date-badge">üìÖ ${dataFormatada}</div>
            <div class="countdown" id="countdown-next">Carregando...</div>
          </div>`;
        const target=new Date(proximoJogo.data+'T00:00:00').getTime();
        const el=document.getElementById('countdown-next');
        const tick=()=>{const now=Date.now();const diff=target-now;
          if(diff<=0){el.textContent='√â dia de jogo!';clearInterval(timer);return}
          const d=Math.floor(diff/(1000*60*60*24));const h=Math.floor((diff%(1000*60*60*24))/(1000*60*60));
          el.textContent=`Faltam ${d}d ${h}h`};
        const timer=setInterval(tick,1000*60); tick();
      }else{
        nextGameContainer.innerHTML=`<h4>Fim de Temporada!</h4><p class="match">Aguarde o calend√°rio do pr√≥ximo ano.</p>`;
      }
    }

    function isMobile(){return window.matchMedia('(max-width: 768px)').matches}

    function renderJogadores(){
      const tbody=document.querySelector('#jogadores-table tbody');
      const cards=document.getElementById('jogadores-cards');
      tbody.innerHTML=''; cards.innerHTML='';
      const usarCards=isMobile()||DESKTOP_CARDS_JOGADORES;
      siteData.jogadores.forEach(j=>{
        if(usarCards){
          const div=document.createElement('div'); div.className='item-card';
          div.innerHTML=`<div class="item-title">${j.nome}</div><div class="item-sub">Posi√ß√£o: ${j.posicao}</div>`;
          cards.appendChild(div);
        }else{
          tbody.innerHTML+=`<tr><td>${j.nome}</td><td>${j.posicao}</td></tr>`;
        }
      });
      document.getElementById('jogadores-table').style.display=usarCards?'none':'table';
      cards.style.display=usarCards?'grid':'none';
    }

    function renderCalendario(){
      const tbody=document.querySelector('#calendario-table tbody');
      const cards=document.getElementById('calendario-cards');
      tbody.innerHTML=''; cards.innerHTML='';
      const proximosJogos=siteData.calendario.filter(j=>!j.resultado).sort((a,b)=>new Date(a.data)-new Date(b.data));
      const usarCards=isMobile()||DESKTOP_CARDS_CALENDARIO;
      proximosJogos.forEach(j=>{
        const dataFormatada=new Date(j.data+'T00:00:00').toLocaleDateString('pt-BR');
        if(usarCards){
          const div=document.createElement('div'); div.className='item-card';
          div.innerHTML=`<div class="item-title">AFC x ${j.adversario}</div><div class="item-sub">üìÖ ${dataFormatada}</div>`;
          cards.appendChild(div);
        }else{
          tbody.innerHTML+=`<tr><td>${dataFormatada} ‚Äì AFC x ${j.adversario}</td></tr>`;
        }
      });
      document.getElementById('calendario-table').style.display=usarCards?'none':'table';
      cards.style.display=usarCards?'grid':'none';
    }

    function getHistoricoData(){
      const jogosPassados=siteData.calendario.filter(j=>j.resultado).map(j=>{
        if(!j.resultado.includes('x')) return {...j,golsAFC:0,golsAdv:0};
        const [gA,gB]=j.resultado.split('x').map(Number); return {...j,golsAFC:gA,golsAdv:gB};
      });
      const statsPorAdv={};
      jogosPassados.forEach(j=>{
        if(!statsPorAdv[j.adversario]) statsPorAdv[j.adversario]={j:0,v:0,e:0,d:0,gp:0,gc:0};
        const s=statsPorAdv[j.adversario];
        s.j++; s.gp+=j.golsAFC; s.gc+=j.golsAdv;
        if(j.golsAFC>j.golsAdv) s.v++; else if(j.golsAFC<j.golsAdv) s.d++; else s.e++;
      });
      return {jogosPassados,statsPorAdv};
    }

    function renderHistorico(){
      const {jogosPassados,statsPorAdv}=getHistoricoData();
      const select=document.getElementById('adversario-select');
      const resumoDiv=document.getElementById('historico-resumo');
      const tbody=document.querySelector('#historico-jogos-passados-table tbody');
      const cards=document.getElementById('historico-passados-cards');

      select.innerHTML='<option value="">-- Escolha um time --</option>';
      resumoDiv.innerHTML=''; tbody.innerHTML=''; cards.innerHTML='';

      Object.keys(statsPorAdv).sort().forEach(adv=>{select.innerHTML+=`<option value="${adv}">${adv}</option>`;});

      jogosPassados.sort((a,b)=>new Date(b.data)-new Date(a.data));
      const usarCards=isMobile();
      jogosPassados.forEach(j=>{
        const dataFormatada=new Date(j.data+'T00:00:00').toLocaleDateString('pt-BR');
        if(usarCards){
          const div=document.createElement('div'); div.className='item-card';
          div.innerHTML=`<div class="item-title">${dataFormatada} ‚Ä¢ ${j.resultado}</div>
                         <div class="item-sub">Advers√°rio: ${j.adversario}</div>
                         <div class="item-sub">${j.detalhes||'-'}</div>`;
          cards.appendChild(div);
        }else{
          tbody.innerHTML+=`<tr><td>${dataFormatada}</td><td>${j.adversario}</td><td>${j.resultado}</td><td>${j.detalhes||'-'}</td></tr>`;
        }
      });
      document.getElementById('historico-jogos-passados-table').style.display=usarCards?'none':'table';
      cards.style.display=usarCards?'grid':'none';

      select.onchange=function(){
        const adversario=this.value; if(!adversario){resumoDiv.innerHTML='';return;}
        const s=statsPorAdv[adversario];
        resumoDiv.innerHTML=`
          <div class="stats-row">
            <div class="stat-box"><div class="stat-number">${s.j}</div><div class="stat-label">Jogos</div></div>
            <div class="stat-box"><div class="stat-number">${s.v}</div><div class="stat-label">Vit√≥rias</div></div>
            <div class="stat-box"><div class="stat-number">${s.e}</div><div class="stat-label">Empates</div></div>
            <div class="stat-box"><div class="stat-number">${s.d}</div><div class="stat-label">Derrotas</div></div>
            <div class="stat-box"><div class="stat-number">${s.gp}</div><div class="stat-label">Gols Marcados</div></div>
            <div class="stat-box"><div class="stat-number">${s.gc}</div><div class="stat-label">Gols Sofridos</div></div>
          </div>`;
      };
    }

    function renderEstatisticas(){
      const {jogosPassados}=getHistoricoData();
      const v=jogosPassados.filter(j=>j.golsAFC>j.golsAdv).length;
      const e=jogosPassados.filter(j=>j.golsAFC===j.golsAdv).length;
      const d=jogosPassados.filter(j=>j.golsAFC<j.golsAdv).length;
      const gp=jogosPassados.reduce((a,j)=>a+j.golsAFC,0);
      const gc=jogosPassados.reduce((a,j)=>a+j.golsAdv,0);

      document.getElementById('estatisticas-gerais').innerHTML=
        `<div class="stat-box"><div class="stat-number">${v}</div><div class="stat-label">Vit√≥rias</div></div>
         <div class="stat-box"><div class="stat-number">${e}</div><div class="stat-label">Empates</div></div>
         <div class="stat-box"><div class="stat-number">${d}</div><div class="stat-label">Derrotas</div></div>
         <div class="stat-box"><div class="stat-number">${gp}</div><div class="stat-label">Gols Marcados</div></div>
         <div class="stat-box"><div class="stat-number">${gc}</div><div class="stat-label">Gols Sofridos</div></div>`;

      const tbody=document.querySelector('#estatisticas-jogadores-table tbody');
      tbody.innerHTML='';
      const jogadoresComStats=siteData.jogadores.filter(j=>j.gols>0||j.assistencias>0)
        .sort((a,b)=>(b.gols+b.assistencias)-(a.gols+a.assistencias));
      jogadoresComStats.forEach(j=>{
        tbody.innerHTML+=`<tr><td>${j.nome}</td><td>${j.posicao}</td><td>${j.gols}</td><td>${j.assistencias}</td></tr>`;
      });
      renderBarChart(jogadoresComStats);
    }

    function renderBarChart(jogadores){
      const c=document.getElementById('bars-container'); c.innerHTML='';
      if(!jogadores.length){c.innerHTML='<div class="item-sub">Sem dados de gols/assist√™ncias no momento.</div>';return;}
      const max=Math.max(...jogadores.map(j=>Math.max(j.gols,j.assistencias)),1);
      jogadores.forEach(j=>{
        const row=document.createElement('div'); row.className='bar';
        row.innerHTML=`<div class="label">${j.nome}</div>
                       <div class="track">
                         <div class="fill-goals" style="width:0%"></div>
                         <div class="fill-assists" style="width:0%"></div>
                       </div>`;
        const values=document.createElement('div'); values.className='values';
        values.textContent=`Gols: ${j.gols} ‚Ä¢ Assist.: ${j.assistencias}`;
        row.appendChild(values); c.appendChild(row);
        requestAnimationFrame(()=>{
          row.querySelector('.fill-goals').style.width=Math.round((j.gols/max)*100)+'%';
          row.querySelector('.fill-assists').style.width=Math.round((j.assistencias/max)*100)+'%';
        });
      });
    }

    function renderGaleria(){
      const grid=document.getElementById('gallery-grid'); if(!grid) return;
      grid.innerHTML='';
      const items=Array.isArray(siteData.galeria)?siteData.galeria:[];
      if(!items.length){grid.innerHTML='<div class="item-sub">Ainda n√£o h√° fotos na galeria.</div>';return;}
      items.forEach(item=>{
        const div=document.createElement('div'); div.className='gallery-item';
        div.innerHTML=`<img src="${item.src}" alt="${item.alt||'Foto do grupo'}">`;
        div.addEventListener('click',()=>openLightbox(item.src,item.alt));
        grid.appendChild(div);
      });
    }

    function openLightbox(src,alt){
      const lb=document.getElementById('lightbox'); const img=document.getElementById('lightbox-img');
      img.src=src; img.alt=alt||'Foto ampliada'; lb.classList.add('open');
    }
    function closeLightbox(){const lb=document.getElementById('lightbox'); const img=document.getElementById('lightbox-img'); img.src=''; lb.classList.remove('open')}
    document.getElementById('lightbox').addEventListener('click',(e)=>{if(e.target.id==='lightbox'||e.target.id==='lightbox-close') closeLightbox()});
    document.addEventListener('keydown',(e)=>{if(e.key==='Escape') closeLightbox()});

    function initSite(){renderHome();renderJogadores();renderCalendario();renderHistorico();renderEstatisticas();renderGaleria()}
    document.addEventListener('DOMContentLoaded',initSite);

    document.querySelectorAll('nav .menu-item').forEach(btn=>btn.addEventListener('click',()=>{
      document.querySelectorAll('main section').forEach(sec=>sec.classList.remove('active'));
      document.getElementById(btn.dataset.tab).classList.add('active');
      document.querySelectorAll('nav .menu-item').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      if(btn.dataset.tab==='jogadores') renderJogadores();
      if(btn.dataset.tab==='calendario') renderCalendario();
      if(btn.dataset.tab==='historico') renderHistorico();
      if(btn.dataset.tab==='estatisticas') renderEstatisticas();
      if(btn.dataset.tab==='home') renderGaleria();
    }));

    window.addEventListener('resize',()=>{
      const current=document.querySelector('section.active')?.id; if(!current) return;
      if(current==='jogadores') renderJogadores();
      if(current==='calendario') renderCalendario();
      if(current==='historico') renderHistorico();
    });

    document.getElementById('admin-btn').addEventListener('click',()=>{
      document.getElementById('admin-login').style.display='flex';
      document.getElementById('admin-msg-login').textContent='';
      document.getElementById('admin-pass').value='';
    });
    function closeAdmin(){document.getElementById('admin-login').style.display='none'}
    function checkPassword(){
      if(document.getElementById('admin-pass').value==='4940'){
        document.querySelectorAll('main section').forEach(sec=>sec.classList.remove('active'));
        document.getElementById('admin-panel').classList.add('active');
        document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
        populateAdminForms(); closeAdmin();
      }else{document.getElementById('admin-msg-login').textContent='Senha incorreta!'}
    }
    window.checkPassword=checkPassword; window.closeAdmin=closeAdmin;

    function populateAdminForms(){
      const calendarioTbody=document.getElementById('admin-calendario-tbody');
      const jogadoresTbody=document.getElementById('admin-jogadores-tbody');
      const galeriaTbody=document.getElementById('admin-galeria-tbody');
      calendarioTbody.innerHTML=''; jogadoresTbody.innerHTML=''; galeriaTbody.innerHTML='';

      siteData.calendario.forEach(jogo=>{
        calendarioTbody.innerHTML+=`
          <tr>
            <td><input type="date" value="${jogo.data}"></td>
            <td><input type="text" value="${jogo.adversario}"></td>
            <td><input type="text" placeholder="ex: 2x1" value="${jogo.resultado||''}"></td>
            <td><input type="text" placeholder="Detalhes dos gols..." value="${jogo.detalhes||''}"></td>
          </tr>`;
      });

      siteData.jogadores.forEach(jogador=>{
        jogadoresTbody.innerHTML+=`
          <tr>
            <td>${jogador.nome} (${jogador.posicao})</td>
            <td><input type="number" value="${jogador.gols}" min="0"></td>
            <td><input type="number" value="${jogador.assistencias}" min="0"></td>
          </tr>`;
      });

      const galeriaItems=Array.isArray(siteData.galeria)?siteData.galeria:[];
      galeriaItems.forEach((foto,idx)=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`
          <td><img class="admin-thumb" src="${foto.src}" alt="${foto.alt||''}"></td>
          <td><input type="text" value="${foto.src||''}" placeholder="URL ou caminho do arquivo"></td>
          <td><input type="text" value="${foto.alt||''}" placeholder="Descri√ß√£o"></td>
          <td><button class="admin-remove" data-idx="${idx}">Remover</button></td>`;
        galeriaTbody.appendChild(tr);
      });

      galeriaTbody.onclick=(e)=>{
        if(e.target.classList.contains('admin-remove')){
          const idx=Number(e.target.getAttribute('data-idx'));
          siteData.galeria.splice(idx,1); saveToStorage(siteData); populateAdminForms();
        }
      };

      document.getElementById('btn-add-galeria-item').onclick=()=>{
        siteData.galeria=Array.isArray(siteData.galeria)?siteData.galeria:[];
        siteData.galeria.push({src:'',alt:''}); saveToStorage(siteData); populateAdminForms();
      };

      document.getElementById('btn-refresh-galeria').onclick=()=>{renderGaleria(); alert('Galeria recarregada na p√°gina In√≠cio.')};
    }

    document.getElementById('btn-generate-from-forms').addEventListener('click',()=>{
      const msg=document.getElementById('admin-msg-generate');
      try{
        const newCalendario=Array.from(document.querySelectorAll('#admin-calendario-tbody tr')).map(row=>{
          const i=row.querySelectorAll('input');
          return {data:i[0].value,adversario:i[1].value,resultado:i[2].value.trim()||null,detalhes:i[3].value};
        });
        const newJogadores=Array.from(document.querySelectorAll('#admin-jogadores-tbody tr')).map((row,index)=>{
          const i=row.querySelectorAll('input'); const base=siteData.jogadores[index];
          return {nome:base.nome,posicao:base.posicao,gols:parseInt(i[0].value||'0',10),assistencias:parseInt(i[1].value||'0',10)};
        });
        const newGaleria=Array.from(document.querySelectorAll('#admin-galeria-tbody tr')).map(row=>{
          const i=row.querySelectorAll('input'); return {src:i[0].value.trim(),alt:i[1].value.trim()};
        }).filter(it=>it.src);

        const newData={jogadores:newJogadores,calendario:newCalendario,galeria:newGaleria};
        generatedJsonString=JSON.stringify(newData,null,2);
        document.getElementById('json-output-area').value=generatedJsonString;
        document.getElementById('btn-download-generated').style.display='inline-block';

        siteData=normalizeData(newData); saveToStorage(siteData); initSite();
        msg.textContent='JSON gerado e salvo no navegador com sucesso!'; msg.style.color='var(--accent)';
      }catch(e){msg.textContent='Erro ao gerar JSON: '+e.message; msg.style.color='#ff6b6b'}
    });

    document.getElementById('btn-download-generated').addEventListener('click',()=>{
      if(!generatedJsonString) return;
      const blob=new Blob([generatedJsonString],{type:'application/json'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='dados_afc_atualizado.json'; a.click();
      URL.revokeObjectURL(a.href);
    });

    document.getElementById('btn-clear-storage').addEventListener('click',()=>{
      localStorage.removeItem(STORAGE_KEY);
      document.getElementById('admin-msg-clear').textContent='Dados locais apagados. Recarregue a p√°gina para voltar aos dados do arquivo.';
    });

    document.getElementById('btn-carregar-json').addEventListener('click',()=>{
      const jsonInput=document.getElementById('json-input-area').value;
      const msg=document.getElementById('admin-msg-load');
      try{
        const newData=JSON.parse(jsonInput);
        if(newData.jogadores && newData.calendario){
          siteData=normalizeData(newData); saveToStorage(siteData); initSite();
          msg.textContent='Dados carregados, salvos no navegador e site atualizado!'; msg.style.color='var(--accent)';
        }else{throw new Error('Formato do JSON inv√°lido.');}
      }catch(e){msg.textContent='Erro ao carregar o JSON: '+e.message; msg.style.color='#ff6b6b'}
    });
  </script>
</body>
</html>